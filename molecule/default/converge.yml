---
- name: Converge
  hosts: all

  vars:
    gdnsd__custom_packages:
      - netbase
    gdnsd__zones:
      # domain without records
      - domain: example.net
      - domain: example.com
        auto_reverse_zone: False
        records:
          # 'A' record
          - name: '{{ ansible_hostname }}'
            target: '{{ ansible_default_ipv4.address }}'
          # 'AAAA' record
          - name: '@'
            type: AAAA
            target: '2606:2800:220:1:248:1893:25c8:1946'
          # 'A' record of domain '@'
          - name: '@'
            target: '{{ ansible_default_ipv4.address }}'
          # 'A' record of wildcard domain
          - name: '*.apps'
            target: '{{ ansible_default_ipv4.address }}'
          # 'CNAME' record
          - name: www
            type: CNAME
            target: example.com
          # 'TXT' record
          - name: ansible
            type: TXT
            target: "tested-by=molecule"
          # 'MX' record
          - type: MX
            target: '{{ ansible_default_ipv4.address }}'
      # reverse only domain
      - reverse_zone: '42.10.in-addr.arpa'
        mailbox: 'hostmaster@example.com'
        nameservers:
          - '{{ ansible_hostname }}.example.com'
        primary_nameserver: '{{ ansible_hostname }}.example.com'
        records:
          - name: '10.0'
            type: PTR
            target: '{{ ansible_hostname }}.example.com.'

  roles:
    - role: ganto.gdnsd
